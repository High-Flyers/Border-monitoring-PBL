<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PBL - RAPORT</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="main">
        <nav>
            <div class="logo">
                <img src="../public/polsl_logo.png">
            </div>
            <div class="logo_hf">
                <h1 class="animate_character">HIGH<br>FLYERS</h1>
            </div>
            <div class="nav-links">
                <ul>
                    <li><a href="./">Home</a></li>
                    <li><a href="./map">Mapa</a></li>
                    <li><a href="./raport">Raport</a></li>
                    <li><a href="./stream">Live feed</a></li>
                </ul>
            </div>
        </nav>
    </div>
    <div class="raport_background">
        <div id="main_container">
            <h3><span class="first_two_words">Real-Time</span> Drone Data:</h3>
        </div>
    </div>

    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script>
        function createDetection(data) {
            const container = document.getElementById('main_container')

            const detection = document.createElement("div");
            detection.classList.add("id_container");

            const date = new Date(data.timestamp * 1000).toLocaleString('en-GB', { timeZone: 'UTC' });

            const info_container = document.createElement("div");
            info_container.classList.add("info_container");
            info_container.innerHTML = `<h3> Time: ${date}, <br> Latitude: ${data.latitude}, <br> Longitude: ${data.longitude}</h4>`;
            detection.appendChild(info_container);

            const img = document.createElement('img');
            img.classList.add('image_container');
            img.src = `data:image/png;base64, ${data.image}`;
            detection.appendChild(img);

            container.appendChild(detection);
        }

        var socket = io();

        socket.on("new_detection", (det) => {
            createDetection(det);
        });

        socket.emit("new_client");
    </script>
</body>

</html>